<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-图像处理/3DLUT" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">3DLUT | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xalwayswill.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xalwayswill.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xalwayswill.github.io/docs/图像处理/3DLUT"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3DLUT | My Site"><meta data-rh="true" name="description" content="addrlut0 = (x+xodd) + (y+yodd)9 + (z+z_odd)81"><meta data-rh="true" property="og:description" content="addrlut0 = (x+xodd) + (y+yodd)9 + (z+z_odd)81"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xalwayswill.github.io/docs/图像处理/3DLUT"><link data-rh="true" rel="alternate" href="https://xalwayswill.github.io/docs/图像处理/3DLUT" hreflang="en"><link data-rh="true" rel="alternate" href="https://xalwayswill.github.io/docs/图像处理/3DLUT" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ce37c9a8.css">
<script src="/assets/js/runtime~main.58983a80.js" defer="defer"></script>
<script src="/assets/js/main.8555064f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/FPGA-IC/8B10B编码">FPGA-IC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/System-Verilog/Assertion">System-Verilog</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/save this to git code reponsitories/2021-01-27">save this to git code reponsitories</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/script/CSH">script</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/work-log---arm-china/2023-08-15">work-log---arm-china</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/work-log---g/2024-09-24">work-log---g</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/功能安全/低功耗相关">功能安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/图像处理/3DLUT">图像处理</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/图像处理/3DLUT">3DLUT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/5A">5A</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/Architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/DPF">DPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/Dither">Dither</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/RGB2YUV-and-YUV2RGB">RGB2YUV-and-YUV2RGB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/RGBIR-sensor">RGBIR-sensor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/RNR">RNR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/bicubic">图像重采样算法之bicubic双立方插值算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/de-noise">de-noise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/demosaic">demosaic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/sharpen">sharpen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/乱七八糟">乱七八糟</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/去紫边">去紫边</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/图像色域空间">RGB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/图像预处理校正简介">1. DPC（Defect Pixel Correction，坏点校正）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/小波变换">小波变换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/常见分辨率">常见分辨率</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/开发工具/Graphviz---绘制图形网络">开发工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/接口协议/CameraLink">接口协议</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/环境配置/Anaconda-配置多环境">环境配置</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/移知网课程/AMBA-APB-AHB-AXI">移知网课程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/随笔/ImageData-sv">随笔</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/面试题目记录/为什么使用与非门而不是或非门进行逻辑面积评估？">面试题目记录</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">图像处理</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3DLUT</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><header><h1>3DLUT</h1></header><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">### Reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[基于三维查找表插值算法的显示器色彩空间转换模型的研究](http://www.designartj.com/ch/reader/download_pdf_file.aspx?journal_id=bzgcgk&amp;file_name=3618E016C89268EC5BE49414EEAFA92CB53D69655D08E5174753FBA88B67B54B3F8D784C32E993DF87584989526651CE596418DBB66B75AB5039015AA6EB0622&amp;open_type=self&amp;file_no=201105021)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[How to create a color gamut](https://zhuanlan.zhihu.com/p/304729311)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Applications of Tetrahedral Interpolation in Color Conversion Model](https://ieeexplore.ieee.org/document/4722591)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3D LUT interpolation](https://community.acescentral.com/uploads/default/original/2X/5/518c5ede1ca11c4a7e13f9c7350e2228bb8762c7.pdf)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**使用的是四面体插值，而非三线性插值，计算量小，效果精度更高，论文中的方法使用的是判断当前点在哪个四面体内部，然后当前点与另外四个顶点组成四个四面体，四个四面体面积之和等于大的四面体的面积，根据面积占比去划分各部分的权重**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">本文都假定顶点排序按照01234567（从下到上，顺时针旋转）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">将大的立方体拆分成小的立方体，每个立方体总共八个顶点，分别存在8个sram中，然后根据像素位置来取顶点值进行计算，**LUT表是11bit，有符号数**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRAM的读取操作，将所有小立方体的顶点存在8个sram中，通过RGB值判断落在哪个立方体内，然后根据RGB三个维度的坐标去SRAM中取对应的lut值，只有奇数或偶数的立方体有顶点，通过index的最低为来判断是选择当前index还是下一个index。（例如，假设像素落在偶数立方体，同时顶点坐标都是按照偶数立方体计算，则只需要按照坐标取当前立方体的顶点。而当像素落在奇数立方体中，则需要前后两个立方体的顶点值进行拼接来计算）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">对于17*17*17的lut，小立方体八个顶点各自对应的数目分别为：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|lut name| number（x*y*z） </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--|--|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_0 | 9x9x9=729</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_1 | 8x9x9=648</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_2 | 9x8x9=648</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_3 | 8x8x9=576</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_4 | 9x9x8=648</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_5 | 8x9x8=576</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_6 | 9x8x8=576</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lut_7 | 8x8x8=512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">首先根据RGB值对应的index，xyz来从sram中取数据，如果x为奇数，则在x轴方向取顶点0，2，4，6时多向后一个index ，如果y为奇数，则在y轴方向取顶点0，1，4，5时向后一个index，如果z为奇数，则在取顶点0，1，2，3时向后一个index，也就得到如下所示的index计算方法</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>addr_lut_0 = (x+x_odd) + (y+y_odd)<em>9 + (z+z_odd)<em>81
addr_lut_1 = x               + (y+y_odd)<em>9 + (z+z_odd)<em>72
addr_lut_2 = (x+x_odd) +               y</em>8 + (z+z_odd)<em>72
addr_lut_3 = x               +               y</em>8 +  (z+z_odd)<em>64
addr_lut_4 = (x+x_odd) + (y+y_odd)<em>9 +                z</em>81
addr_lut_5 = x               + (y+y_odd)<em>9 +                z</em>72
addr_lut_6 = (x+x_odd) +               y</em>9 +                z</em>72
addr_lut_7 = x               +               y</em>8 +                z</em>64</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在从SRAM中取出对应的lut值后，由于不同的pixel落在的位置不同，取出的8个顶点坐标顺序需要重新排列，例如cude(1,0,0)的顶点0的坐标是cude(0,0,0)的顶点3，**因此需要根据pixel计算出来的xyz的奇偶性，来对读出的顶点坐  标进行不同的重排列，然后进行插值（并不是三线性差值，寻找当前点所在的立方锥也就是四面体进行插值，不是立方体而是四面体）**。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| target | equal | code (xyz)|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-|-|-|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cude_0(x,y,z) | cude_0(x,y,z) | 000  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_1(x+1,y,z) | 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_2(x,y+1,z) | 010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_3(x+1,y+1,z) | 110</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_4(x,y,z+1) | 001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_5(x+1,y,z+1) | 101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_6(x,y+1,z+1) | 011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_7(x+1,y+1,z+1) | 111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| target | equal | code(~xyz) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-|-|-|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cude_1(x,y,z) | cude_1(x,y,z) | 000  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_0(x+1,y,z) | 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_3(x,y+1,z) | 010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_2(x+1,y+1,z) | 110</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_5(x,y,z+1) | 001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_4(x+1,y,z+1) | 101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_7(x,y+1,z+1) | 011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_6(x+1,y+1,z+1) | 111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| target | equal | code(x~yz) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-|-|-|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cude_2(x,y,z) | cude_2(x,y,z) | 000  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_3(x+1,y,z) | 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_0(x,y+1,z) | 010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_1(x+1,y+1,z) | 110</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_6(x,y,z+1) | 001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_7(x+1,y,z+1) | 101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_4(x,y+1,z+1) | 011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| | cude_5(x+1,y+1,z+1) | 111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cude_0(2a-1,2b-1,2c-1) = lut_0()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">17\*17\*17\*3的lut表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">整个LUT表共有17\*17\*17\*3(RGB)个lut值，每个lut值12bit，空间划分为16\*16\*16个立方体，每个lut值对应小立方体的顶点，总共17\*17\*17个顶点可划分为3类，大立方体外侧角上的顶点对应的sram大小为9\*9\*9=729，该类顶点有1组，大立方体侧边上的点对应的sram大小为8\*9\*9=648，该类顶点有3组，立方体上下面顶点对应的sram大小为9\*8\*8=576，共3组，大立方体内侧的顶点为8\*8\*8=512，共1组。合计729+648\*3+576\*3+512=4913，小立方体的8个顶点存放在不同的sram中，8个三维的lut表。TT中是每次读取两组lut值，然后根据像素落在奇数还是偶数小立方体中来对读出的lut值进行组合变成所需要的小立方体的顶点lut值，然后进行三线性插值。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TODO：详细的分布图后面整理下画一下，也可以考虑下自己实现时可以怎么操作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRAM的使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|Type| Bit mask| depth|width|num|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-|-|-|-|-|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|sp|Y|729|36|1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|sp|Y|648|36|3|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|sp|Y|576|36|3|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|sp|Y|512|36|1|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> RTL实现时通过配置sram_sel的寄存器来进行不同顶点sram的配置，通过wr_chn_sel和rd_chn_sel来对通道进行选择，总共组合起来有8*3=24个sel的选择，节约AHB地址空间（为何lut的数据位宽是12bit）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRAM的读取操作，将所有小立方体的顶点存在8个sram中，通过RGB值判断落在哪个立方体内，然后根据RGB三个维度的坐标去SRAM中取对应的lut值，只有奇数或偶数的立方体有顶点，通过index的最低位来判断是选择当前index还是下一个index。（例如，假设像素落在偶数立方体，同时顶点坐标都是按照偶数立方体计算，则只需要按照坐标取当前立方体的顶点。而当像素落在奇数立方体中，则需要前后两个立方体的顶点值进行拼接来计算）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">里面有个找RGB最大值的运算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rgtg = (diffR &gt;= diffG) //R is greater than G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggtb = (diffG &gt;= diffB)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bgtr = (diffB &gt;= diffR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">idxP0 = (iR, iG, iB) //当前立方体原点的坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用Rmax表示RGB分量中R最大，则</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rmax = rgtg &amp; ~bgtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gmax = ggtb &amp; ~rgtg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bmax = bgtr &amp; ~ggtb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">idxR1 = {iR+Rmax, iG+Gmax, iB+Bmax} //当前立方体从原点向RGB最大分量方向偏移的坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">idxP2 = {iR+Rmed, iG+Gmed, B+Bmedi} //当前立方体从原点向非RGB最小分量方向偏移的坐标</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">idxP3 = {iR+1, iG+1, iB+1}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">最终四个坐标组成一个立方锥，然后插值（但是感觉这个算法不对劲）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RGB分量最大值方向（也就是最接近的顶点）乘以该分量的系数，中间分量和小分量分别乘以各自的系数。（实际就是四个顶点，哪个离得近哪个占比高，加权累加）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/图像处理/3DLUT.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/功能安全/低功耗相关"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">减低功耗的优点</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/图像处理/5A"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">5A</div></a></nav></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>