<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-图像处理/去紫边" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">去紫边 | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xalwayswill.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xalwayswill.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xalwayswill.github.io/docs/图像处理/去紫边"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="去紫边 | My Site"><meta data-rh="true" name="description" content="code"><meta data-rh="true" property="og:description" content="code"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xalwayswill.github.io/docs/图像处理/去紫边"><link data-rh="true" rel="alternate" href="https://xalwayswill.github.io/docs/图像处理/去紫边" hreflang="en"><link data-rh="true" rel="alternate" href="https://xalwayswill.github.io/docs/图像处理/去紫边" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ce37c9a8.css">
<script src="/assets/js/runtime~main.58983a80.js" defer="defer"></script>
<script src="/assets/js/main.8555064f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/FPGA-IC/8B10B编码">FPGA-IC</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/System-Verilog/Assertion">System-Verilog</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/save this to git code reponsitories/2021-01-27">save this to git code reponsitories</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/script/CSH">script</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/work-log---arm-china/2023-08-15">work-log---arm-china</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/work-log---g/2024-09-24">work-log---g</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/功能安全/低功耗相关">功能安全</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/图像处理/3DLUT">图像处理</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/3DLUT">3DLUT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/5A">5A</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/Architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/DPF">DPF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/Dither">Dither</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/RGB2YUV-and-YUV2RGB">RGB2YUV-and-YUV2RGB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/RGBIR-sensor">RGBIR-sensor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/RNR">RNR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/bicubic">图像重采样算法之bicubic双立方插值算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/de-noise">de-noise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/demosaic">demosaic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/sharpen">sharpen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/乱七八糟">乱七八糟</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/图像处理/去紫边">去紫边</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/图像色域空间">RGB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/图像预处理校正简介">1. DPC（Defect Pixel Correction，坏点校正）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/小波变换">小波变换</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/图像处理/常见分辨率">常见分辨率</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/开发工具/Graphviz---绘制图形网络">开发工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/接口协议/CameraLink">接口协议</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/环境配置/Anaconda-配置多环境">环境配置</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/移知网课程/AMBA-APB-AHB-AXI">移知网课程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/随笔/ImageData-sv">随笔</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/面试题目记录/为什么使用与非门而不是或非门进行逻辑面积评估？">面试题目记录</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">图像处理</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">去紫边</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>去紫边</h1></header><p><a href="https://github.com/mjambon/purple-fringe" target="_blank" rel="noopener noreferrer">code</a>
<a href="https://blog.csdn.net/Aoman_Hao/article/details/105753372" target="_blank" rel="noopener noreferrer">转载</a>
<a href="https://blog.csdn.net/Aoman_Hao/article/details/113797420" target="_blank" rel="noopener noreferrer">转载</a>
<a href="https://www.qinxing.xyz/posts/e72969e7/" target="_blank" rel="noopener noreferrer">ISP相关个人主页</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="个人理解">个人理解<a href="#个人理解" class="hash-link" aria-label="Direct link to 个人理解" title="Direct link to 个人理解">​</a></h2>
<p>###成因
感觉主要两方面，一是镜头色差（主要），二是demosaic造成的图像边缘的false color
镜头尽量满足可见光部分多数区域对焦需求，而对于短波长（紫光，紫外线）产生相反影响，最终导致图像出现紫边模糊。
<strong>高亮，高对比度（边缘），远离中心（横向色差越明显）</strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-轴向色差">1. 轴向色差<a href="#1-轴向色差" class="hash-link" aria-label="Direct link to 1. 轴向色差" title="Direct link to 1. 轴向色差">​</a></h4>
<p>由于传感器对绿色敏感，通常以绿色平面作为基准。聚焦后，绿色光束经过透镜，形成了一个绿色的点，而红色和蓝色在sensor上形成了一个弥散圆。右侧是轴向色差的效果图，理想中应该是黑色的图上一个个白点，实际效果是白点周围包裹着一层紫边
<img decoding="async" loading="lazy" src="/assets/images/23495115-aa1350eb19300854-9b10e836145976084cc8d9e5be192149.png" width="954" height="617" class="img_ev3q"></p>
<p>特点
色差颜色随着焦点的移动而变化的时候（手动调整聚焦位置），我们认为出现了纵向色差，举个例子，焦点在前面会偏紫，焦点在后面会偏绿，就是纵向色差
缩小光圈可以抑制纵向色差（因为缩小光圈可以缩小弥散圆）
如果在画面中央出现，也可以认为是纵向色差，因为横向一般边缘更加严重，纵向色差的分布均匀的分布在整张图像内
####2. 横向色差</p>
<p>大部分场景都是横向色差。不同波长的光经过透镜折射后，落在sensor横向上的不同位置上。从右侧的图可以看出，中心的色差很小，边缘的色差很大，由内而外，色差的颜色依次以红黄蓝的顺序变化。
<img decoding="async" loading="lazy" src="/assets/images/23495115-082867c6a69e73b8-41c7c8a3308520e6f559c23f3271fe08.png" width="1045" height="623" class="img_ev3q"></p>
<p>特点
拍摄一个物体的时候，在物体的一侧出现紫边，在另外一侧出现另外一种颜色，如绿边
从图像中心到边缘，横向色差会变得越来越严重
调节光圈无法减弱紫边
所以需要radial weight</p>
<p>###现象
高反差， 大背光图像时候容易出现，示例图片如下面的dog
##处理方法
产生蓝色蒙版减去部分蓝色分量？</p>
<p>图像紫边存在数码相机、监控摄像头等数字成像图像，使用设备在逆光、大光圈条件下拍摄图像的高反差区域容易出现紫边，解决图像自编问题有助设备得到完美图像。</p>
<p>紫边成因分析和确定有助与紫边消除的图像处理算法研究和摄像设备工程改进，能够改善自编的硬件成本更高，非常需要研究去除紫边的图像处理算法。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="紫边">紫边<a href="#紫边" class="hash-link" aria-label="Direct link to 紫边" title="Direct link to 紫边">​</a></h2>
<p>通过取色器中对“紫边”的色彩分析，可以发现，大部分紫边的主要构成就是洋红，这些紫边是由于高反差大背光静物边缘，产生光学衍射，加上DC/DV的CCD在色彩插值导致。</p>
<p>因为人对红、绿、蓝三种颜色的中绿分量比较敏感，大多sensor的bayer排列大多采样绿分量比较多，例如RGGB排列。
绿色采样结果比较多,相比红色和蓝色通道来说不容易发生混叠，而红蓝分量组合后表现为洋红色，与取色器的表现接近。</p>
<p>硬件改善紫边（镜头、sensor）
尽量选择低色差的镜头，验证色差曲线。sensor选择像元面积较大，保证光入射角度较大，亦可以规避shading问题。</p>
<p>算法改善
在RGB域检测紫边</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="高亮区域检测">高亮区域检测<a href="#高亮区域检测" class="hash-link" aria-label="Direct link to 高亮区域检测" title="Direct link to 高亮区域检测">​</a></h2>
<p>首先对R、G、B分别设置固定的亮度阈值，把图像分为很多块，精确一点可以选择5<em>5大小的邻域，粗糙一点可以选13</em>13，判断邻域内每一个像素点的R、G、B值是否超过R、G、B初设亮度阈值（可能不同），邻域内超过R、G、B初设亮度阈值的像素记录数目分别为RNum、GNum、BNum，，当RNum、GNum、BNum同时满足＞设定的高亮区域像素数阈值（R、G、B三通道可能不同）时，判定该区域为高亮区域。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="边缘区域检测">边缘区域检测<a href="#边缘区域检测" class="hash-link" aria-label="Direct link to 边缘区域检测" title="Direct link to 边缘区域检测">​</a></h2>
<p>既可以使用常用的边缘检测算子Roberts 梯度算子、拉普拉斯梯度算子等，也可以分析像素区域方差趋势来判断是否属于边缘。统计区域内像素方差，判断方差值与初设方差阈值的大小，只有大于该阈值的区域才被认为是边缘。</p>
<p>满足以上高亮和边缘区域多个条件的像素可以认为是紫边。</p>
<p>矫正紫边
紫边区域紫色饱和度淡化，具体措施不晓得，再看看文献好了</p>
<h1>Unpurple</h1>
<p>Unpurple is a tool for removing purple fringes (axial chromatic aberration) from digital photos using a heuristic of my own.</p>
<p>This is the original OCaml implementation which produces a standalone executable with a simple command-line interface. It is fast enough (~ one second per megapixel) but doesn&#x27;t preserve Exif data and the JPEG compression factor is fixed at 75%.</p>
<p>Unpurple was <a href="https://github.com/dtschump/gmic-community/blob/master/include/stanislav_paskalev.gmic" target="_blank" rel="noopener noreferrer">ported</a> to <a href="https://gmic.eu/" target="_blank" rel="noopener noreferrer">G&#x27;MIC</a> by <a href="https://github.com/solarsea" target="_blank" rel="noopener noreferrer">Stanislav Paskalev</a>, allowing its use from <a href="https://www.gimp.org/" target="_blank" rel="noopener noreferrer">GIMP</a> and other image-manipulation software. </p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example"><a href="https://github.com/mjambon/purple-fringe#example" target="_blank" rel="noopener noreferrer"></a>Example<a href="#example" class="hash-link" aria-label="Direct link to example" title="Direct link to example">​</a></h2>
<p>Before:</p>
<p><a href="https://github.com/mjambon/purple-fringe/blob/master" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://upload-images.jianshu.io/upload_images/23495115-c0d04d2db432e0bb?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Before" class="img_ev3q"></a></p>
<p>After:</p>
<p><a href="https://github.com/mjambon/purple-fringe/blob/master" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://upload-images.jianshu.io/upload_images/23495115-7fb33341d7f245e2?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="After" class="img_ev3q"></a></p>
<p>Difference:</p>
<p><a href="https://github.com/mjambon/purple-fringe/blob/master" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://upload-images.jianshu.io/upload_images/23495115-5d527f0d61e751bd?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Difference" class="img_ev3q"></a></p>
<p><a href="https://mjambon.github.io/mjambon2016/purple-fringe/examples.html" target="_blank" rel="noopener noreferrer">More examples</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-outline"><a href="https://github.com/mjambon/purple-fringe#algorithm-outline" target="_blank" rel="noopener noreferrer"></a>Algorithm outline<a href="#algorithm-outline" class="hash-link" aria-label="Direct link to algorithm-outline" title="Direct link to algorithm-outline">​</a></h2>
<ol>
<li>Produce a blurred mask from the blue component in the original image.</li>
<li>Subtract from the original image some amount of blue and red based on the intensities found in the blurred mask, using the following constraints:<!-- -->
<ul>
<li>Blue level may not drop below green level.</li>
<li>Red level may not drop below green level.</li>
<li>Red<!-- -->:blue<!-- --> ratio may not drop below some constant.</li>
</ul>
</li>
</ol>
<p>Please refer to the implementation for details and default parameters.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="intuition-and-future-prospects"><a href="https://github.com/mjambon/purple-fringe#intuition-and-future-prospects" target="_blank" rel="noopener noreferrer"></a>Intuition and future prospects<a href="#intuition-and-future-prospects" class="hash-link" aria-label="Direct link to intuition-and-future-prospects" title="Direct link to intuition-and-future-prospects">​</a></h2>
<p>The original motivation for this work was to remove purple fringing from my own photos that I took with a relatively cheap lens. Coming up with an algorithm required:</p>
<ol>
<li>Notions about optics, and in particular understanding why chromatic aberration happens.</li>
<li>Notions about image manipulation and RGB color encoding.</li>
<li>Notions about the visible spectrum (rainbow) and how wavelengths map to certain perceived colors.</li>
<li>Notions about the perception of colors in humans and why computers encode colors as 3 components (excluding brightness or transparency) and not another number.</li>
</ol>
<p>It is useful, or perhaps critical, to understand why mixing blue and red dots produces a perception of purple, even though none of the light emitted from blue and red dots needs to have the wavelength of the purple band of the rainbow. School and Wikipedia are your friends.</p>
<p>Here&#x27;s my mental model of purple fringing, which may be inacurrate but turned out to be good enough. It may not work as well or at all for other types of chromatic aberration:</p>
<p>A camera &quot;lens&quot; is made of several simple lenses, which help not only with zooming in, but also correcting for certain problems. My understanding is that they allow multiple regions of the visible spectrum to remain in focus, but this has the opposite effect on the short wavelengths (purple and ultraviolet) which end up very blurred out. It is also possible that UV light is captured as purple by the sensor of a digital camera. As a result, black objects on a white background will exhibit a purple fringe all around. Note that this is different then some other types of chromatic aberration, where some objects have a red margin on one side and a blue margin on the other side.</p>
<p>Now for the method. The problem of removing the purple fringe is tackled by observing that the bright parts of the image still contain most of the purple that they should contain. We don&#x27;t need to take the purple from the purple fringes and put it back into the bright areas. They&#x27;re still plenty bright and their colors look natural. We assume that they still contain most of the indigo-purple color corresponding to the short wavelengths, in the correct location. So instead of trying to locate a purple fringe in the hope of removing it, we create a purple fringe from the image which already has a purple fringe. This involves selecting the blue-purple component of the image, which is a combination of blue and red within some acceptable ratio and blurring it. The result is a mask that if added to the original image would produce a purple fringe roughly like the one we want to remove. What remains to do is somehow subtract this approximate artificial purple fringe mask from the original. The first problem is that our artificial fringe is most likely wider and more intense that the actual fringe we want to remove, and we don&#x27;t want to remove too much so as to not introduce new colors. The second problem is that we don&#x27;t want to remove the blue-purple component from the bright areas of the image. These problems are solved by:</p>
<ol>
<li>Subtracting the purple mask only where it&#x27;s brighter than the original purple component.</li>
<li>Subtracting purple only from regions that are somewhat purple, and at most until they look grey. For example, from a dark purplish pixel like (red = 0.3, green = 0.1, blue = 0.3), we may consider a purple fringe mask of (0.25, 0, 0.25). If we subtracted this mask directly, we would get (0.05, 0.1, 0.05) and now the pixel would be greenish! We avoid this by ensuring that at worst we turn a pixel grey. In this case, our resulting pixel would be (0.1, 0.1, 0.1), which is a dark grey rather than an undesirable dark green.</li>
</ol>
<p>This is what the current transformations try to do, and it works often well, which is sometimes surprising. Some areas where a purple fringe was removed look greyer than they probably should, but the grey color has the advantage of being discreet.</p>
<p>Some people have asked about removing green fringing. The current algorithm won&#x27;t remove it. However, it&#x27;s possible that a similar algorithm would work. I estimate it would take at least a couple of days to obtain a proof of concept, if it is feasible. I hope the explanations above may help whoever is interested in adding support for green-fringe removal.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/图像处理/去紫边.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/图像处理/乱七八糟"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">乱七八糟</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/图像处理/图像色域空间"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">RGB</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#个人理解" class="table-of-contents__link toc-highlight">个人理解</a></li><li><a href="#紫边" class="table-of-contents__link toc-highlight">紫边</a></li><li><a href="#高亮区域检测" class="table-of-contents__link toc-highlight">高亮区域检测</a></li><li><a href="#边缘区域检测" class="table-of-contents__link toc-highlight">边缘区域检测</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#algorithm-outline" class="table-of-contents__link toc-highlight">Algorithm outline</a></li><li><a href="#intuition-and-future-prospects" class="table-of-contents__link toc-highlight">Intuition and future prospects</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>